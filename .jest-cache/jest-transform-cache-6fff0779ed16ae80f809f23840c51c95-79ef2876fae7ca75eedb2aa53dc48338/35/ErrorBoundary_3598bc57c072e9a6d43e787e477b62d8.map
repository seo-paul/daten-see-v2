{"version":3,"names":["ErrorBoundary","_react","Component","constructor","props","cov_20152wdwl0","f","s","handleRetry","level","b","_loggerconfig","appLogger","info","component","action","setState","hasError","handleReportIssue","state","errorId","userAction","undefined","errorBoundaryLevel","window","open","getDerivedStateFromError","error","componentDidCatch","errorInfo","context","metadata","componentStack","_nextjs","withScope","scope","setTag","setLevel","setContext","captureException","render","fallback","_jsxruntime","jsx","className","role","jsxs","viewBox","fill","fillRule","d","clipRule","process","env","NODE_ENV","message","stack","onClick","slice","children"],"sources":["/Users/zweigen/Sites/daten-see-v2/src/shared/components/ErrorBoundary.tsx"],"sourcesContent":["'use client';\n\nimport * as Sentry from '@sentry/nextjs';\nimport React, { Component, ReactNode } from 'react';\n\nimport { appLogger } from '@/lib/monitoring/logger.config';\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n  level?: 'page' | 'widget' | 'component';\n  context?: Record<string, unknown>;\n}\n\ninterface State {\n  hasError: boolean;\n  error?: Error;\n  errorId?: string;\n}\n\nexport class ErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    return {\n      hasError: true,\n      error,\n    };\n  }\n\n  override componentDidCatch(error: Error, errorInfo: React.ErrorInfo): void {\n    const { level = 'component', context } = this.props;\n    \n    // Enhanced logging with context\n    appLogger.error(`Error Boundary Triggered (${level})`, {\n      error,\n      component: `error-boundary-${level}`,\n      metadata: {\n        componentStack: errorInfo.componentStack,\n        errorBoundaryLevel: level,\n        ...context,\n      },\n    });\n\n    // Capture to Sentry with enhanced context\n    Sentry.withScope((scope) => {\n      scope.setTag('errorBoundary', level);\n      scope.setLevel('error');\n      scope.setContext('errorInfo', {\n        componentStack: errorInfo.componentStack,\n        level,\n        ...context,\n      });\n      \n      const errorId = Sentry.captureException(error);\n      this.setState({ errorId });\n    });\n  }\n\n  private handleRetry = (): void => {\n    const { level = 'component' } = this.props;\n    appLogger.info('Error Boundary Retry Attempted', {\n      component: `error-boundary-${level}`,\n      action: 'retry',\n    });\n    \n    this.setState({ hasError: false });\n  };\n\n  private handleReportIssue = (): void => {\n    const { level = 'component' } = this.props;\n    if (this.state.errorId) {\n      appLogger.userAction('report-error', undefined, {\n        errorId: this.state.errorId,\n        errorBoundaryLevel: level,\n      });\n      \n      // In production, this could open a support ticket\n      if (typeof window !== 'undefined') {\n        window.open(\n          `mailto:support@daten-see.com?subject=Error Report - ${this.state.errorId}&body=Error ID: ${this.state.errorId}%0A%0APlease describe what you were doing when this error occurred.`,\n          '_blank'\n        );\n      }\n    }\n  };\n\n  override render(): ReactNode {\n    if (this.state.hasError) {\n      // Custom fallback UI or use provided fallback\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      const { level = 'component' } = this.props;\n      \n      return (\n        <div className=\"error-boundary-fallback\" data-level={level} role=\"alert\">\n          <div className=\"p-6 bg-red-50 border border-red-200 rounded-lg\">\n            <div className=\"flex items-start\">\n              <div className=\"flex-shrink-0\">\n                <svg\n                  className=\"w-5 h-5 text-red-400\"\n                  viewBox=\"0 0 20 20\"\n                  fill=\"currentColor\"\n                >\n                  <path\n                    fillRule=\"evenodd\"\n                    d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\"\n                    clipRule=\"evenodd\"\n                  />\n                </svg>\n              </div>\n              <div className=\"ml-3\">\n                <h3 className=\"text-sm font-medium text-red-800\">\n                  Oops! Etwas ist schiefgelaufen\n                </h3>\n                <div className=\"mt-2 text-sm text-red-700\">\n                  <p>\n                    {level === 'page' && 'Diese Seite ist auf einen Fehler gestoßen und kann nicht angezeigt werden.'}\n                    {level === 'widget' && 'Dieses Widget ist auf einen Fehler gestoßen und kann nicht angezeigt werden.'}\n                    {level === 'component' && 'Diese Komponente ist auf einen Fehler gestoßen.'}\n                  </p>\n                  \n                  {process.env.NODE_ENV === 'development' && this.state.error && (\n                    <details className=\"mt-2\">\n                      <summary className=\"cursor-pointer font-medium\">\n                        Development Error Details\n                      </summary>\n                      <pre className=\"mt-2 text-xs bg-red-100 p-2 rounded overflow-auto\">\n                        {this.state.error.message}\n                        {'\\n'}\n                        {this.state.error.stack}\n                      </pre>\n                    </details>\n                  )}\n                </div>\n                \n                <div className=\"mt-4 flex space-x-3\">\n                  <button\n                    onClick={this.handleRetry}\n                    className=\"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500\"\n                  >\n                    Seite neu laden\n                  </button>\n                  \n                  {this.state.errorId && process.env.NODE_ENV === 'production' && (\n                    <button\n                      onClick={this.handleReportIssue}\n                      className=\"bg-gray-600 text-white px-3 py-1 rounded text-sm hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500\"\n                    >\n                      Report Issue\n                    </button>\n                  )}\n                  \n                  {this.state.errorId && (\n                    <span className=\"text-xs text-gray-500 self-center\">\n                      Error ID: {this.state.errorId.slice(0, 8)}\n                    </span>\n                  )}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}