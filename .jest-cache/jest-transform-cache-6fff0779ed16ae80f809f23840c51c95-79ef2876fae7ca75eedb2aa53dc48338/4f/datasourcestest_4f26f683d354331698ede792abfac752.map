{"version":3,"sources":["/Users/zweigen/Sites/daten-see-v2/src/lib/api/__tests__/data-sources.test.ts"],"sourcesContent":["/**\n * Data Sources API Service Tests\n * Testing data source CRUD operations and analytics queries\n */\n\nimport type { DataSource, DataSourceType, AnalyticsQuery } from '@/types';\n\nimport { DataSourceService, AnalyticsService } from '../data-sources';\nimport { apiClient } from '../index';\n\n// Mock the API client\njest.mock('../index', () => ({\n  apiClient: {\n    get: jest.fn(),\n    post: jest.fn(),\n    put: jest.fn(),\n    delete: jest.fn(),\n  },\n  createQueryFunction: (fn: Function) => fn,\n}));\n\ndescribe('DataSourceService', () => {\n  const mockApiClient = apiClient as jest.Mocked<typeof apiClient>;\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('getDataSources', () => {\n    const mockDataSources: DataSource[] = [\n      {\n        id: 'ds-1',\n        name: 'Google Analytics',\n        type: 'google_analytics',\n        status: 'connected',\n        organizationId: 'org-1',\n        workspaceId: 'ws-1',\n        lastSync: '2024-01-15T10:00:00Z',\n        config: {\n          accountId: '12345',\n          propertyId: '67890',\n          viewId: '11111',\n        },\n      },\n      {\n        id: 'ds-2',\n        name: 'Analytics API',\n        type: 'rest_api',\n        status: 'connected',\n        organizationId: 'org-1',\n        workspaceId: 'ws-1',\n        lastSync: '2024-01-20T10:00:00Z',\n        config: {\n          baseUrl: 'https://api.analytics.com',\n          authType: 'bearer',\n        },\n      },\n    ];\n\n    it('should get all data sources without workspace filter', async () => {\n      const mockResponse = {\n        data: mockDataSources,\n        success: true,\n      };\n      mockApiClient.get.mockResolvedValueOnce(mockResponse);\n\n      const result = await DataSourceService.getDataSources();\n\n      expect(mockApiClient.get).toHaveBeenCalledWith('/data-sources');\n      expect(result).toEqual(mockDataSources);\n    });\n\n    it('should get data sources filtered by workspace', async () => {\n      const mockResponse = {\n        data: [mockDataSources[0]],\n        success: true,\n      };\n      mockApiClient.get.mockResolvedValueOnce(mockResponse);\n\n      const result = await DataSourceService.getDataSources('ws-1');\n\n      expect(mockApiClient.get).toHaveBeenCalledWith('/data-sources?workspaceId=ws-1');\n      expect(result).toHaveLength(1);\n      expect(result[0].workspaceId).toBe('ws-1');\n    });\n\n    it('should handle empty data sources', async () => {\n      const mockResponse = {\n        data: [],\n        success: true,\n      };\n      mockApiClient.get.mockResolvedValueOnce(mockResponse);\n\n      const result = await DataSourceService.getDataSources();\n\n      expect(result).toEqual([]);\n    });\n\n    it('should handle API errors', async () => {\n      mockApiClient.get.mockRejectedValueOnce(new Error('Network error'));\n\n      await expect(DataSourceService.getDataSources()).rejects.toThrow('Network error');\n    });\n  });\n\n  describe('getDataSource', () => {\n    const mockDataSource: DataSource = {\n      id: 'ds-1',\n      name: 'Production Database',\n      type: 'rest_api',\n      status: 'connected',\n      organizationId: 'org-1',\n      workspaceId: 'ws-1',\n      config: {\n        baseUrl: 'https://db.example.com',\n        authType: 'bearer',\n      },\n    };\n\n    it('should get single data source by ID', async () => {\n      const mockResponse = {\n        data: mockDataSource,\n        success: true,\n      };\n      mockApiClient.get.mockResolvedValueOnce(mockResponse);\n\n      const result = await DataSourceService.getDataSource('ds-1');\n\n      expect(mockApiClient.get).toHaveBeenCalledWith('/data-sources/ds-1');\n      expect(result).toEqual(mockDataSource);\n    });\n\n    it('should handle not found error', async () => {\n      mockApiClient.get.mockRejectedValueOnce(new Error('Data source not found'));\n\n      await expect(DataSourceService.getDataSource('non-existent')).rejects.toThrow('Data source not found');\n    });\n  });\n\n  describe('createDataSource', () => {\n    const createRequest = {\n      name: 'New Data Source',\n      type: 'rest_api' as DataSourceType,\n      config: {\n        baseUrl: 'https://localhost:3306',\n        authType: 'bearer' as const,\n      },\n      workspaceId: 'ws-1',\n    };\n\n    const mockCreatedDataSource: DataSource = {\n      id: 'ds-new',\n      ...createRequest,\n      organizationId: 'org-1',\n      status: 'connected',\n    };\n\n    it('should create new data source', async () => {\n      mockApiClient.post.mockResolvedValueOnce({\n        success: true,\n        data: mockCreatedDataSource,\n      });\n\n      const result = await DataSourceService.createDataSource(createRequest);\n\n      expect(mockApiClient.post).toHaveBeenCalledWith('/data-sources', createRequest);\n      expect(result).toEqual(mockCreatedDataSource);\n    });\n\n    it('should handle creation failure', async () => {\n      mockApiClient.post.mockResolvedValueOnce({\n        success: false,\n        message: 'Invalid configuration',\n      });\n\n      await expect(DataSourceService.createDataSource(createRequest))\n        .rejects.toThrow('Invalid configuration');\n    });\n\n    it('should handle generic creation error', async () => {\n      mockApiClient.post.mockResolvedValueOnce({\n        success: false,\n      });\n\n      await expect(DataSourceService.createDataSource(createRequest))\n        .rejects.toThrow('Failed to create data source');\n    });\n\n    it('should create data source without workspace', async () => {\n      const requestWithoutWorkspace = {\n        name: 'Global Data Source',\n        type: 'rest_api' as DataSourceType,\n        config: {\n          baseUrl: 'https://api.example.com',\n          authType: 'none' as const,\n        },\n      };\n\n      mockApiClient.post.mockResolvedValueOnce({\n        success: true,\n        data: {\n          id: 'ds-global',\n          ...requestWithoutWorkspace,\n          organizationId: 'org-1',\n          status: 'connected',\n        },\n      });\n\n      const result = await DataSourceService.createDataSource(requestWithoutWorkspace);\n\n      expect(result.workspaceId).toBeUndefined();\n    });\n  });\n\n  describe('updateDataSource', () => {\n    const updateRequest = {\n      name: 'Updated Database',\n      config: {\n        baseUrl: 'https://new-db.example.com',\n      },\n    };\n\n    const mockUpdatedDataSource: DataSource = {\n      id: 'ds-1',\n      name: 'Updated Database',\n      type: 'rest_api',\n      status: 'connected',\n      organizationId: 'org-1',\n      workspaceId: 'ws-1',\n      config: {\n        baseUrl: 'https://new-db.example.com',\n        authType: 'bearer',\n      },\n    };\n\n    it('should update data source', async () => {\n      mockApiClient.put.mockResolvedValueOnce({\n        success: true,\n        data: mockUpdatedDataSource,\n      });\n\n      const result = await DataSourceService.updateDataSource('ds-1', updateRequest);\n\n      expect(mockApiClient.put).toHaveBeenCalledWith('/data-sources/ds-1', updateRequest);\n      expect(result).toEqual(mockUpdatedDataSource);\n    });\n\n    it('should update only name', async () => {\n      const nameOnlyUpdate = { name: 'Renamed Database' };\n      \n      mockApiClient.put.mockResolvedValueOnce({\n        success: true,\n        data: { ...mockUpdatedDataSource, name: 'Renamed Database' },\n      });\n\n      const result = await DataSourceService.updateDataSource('ds-1', nameOnlyUpdate);\n\n      expect(mockApiClient.put).toHaveBeenCalledWith('/data-sources/ds-1', nameOnlyUpdate);\n      expect(result.name).toBe('Renamed Database');\n    });\n\n    it('should handle update failure', async () => {\n      mockApiClient.put.mockResolvedValueOnce({\n        success: false,\n        message: 'Connection failed with new config',\n      });\n\n      await expect(DataSourceService.updateDataSource('ds-1', updateRequest))\n        .rejects.toThrow('Connection failed with new config');\n    });\n  });\n\n  describe('deleteDataSource', () => {\n    it('should delete data source', async () => {\n      mockApiClient.delete.mockResolvedValueOnce({ success: true });\n\n      await expect(DataSourceService.deleteDataSource('ds-1')).resolves.not.toThrow();\n\n      expect(mockApiClient.delete).toHaveBeenCalledWith('/data-sources/ds-1');\n    });\n\n    it('should handle delete error', async () => {\n      mockApiClient.delete.mockRejectedValueOnce(new Error('Cannot delete active data source'));\n\n      await expect(DataSourceService.deleteDataSource('ds-1'))\n        .rejects.toThrow('Cannot delete active data source');\n    });\n  });\n\n  describe('testConnection', () => {\n    it('should test successful connection', async () => {\n      mockApiClient.post.mockResolvedValueOnce({\n        success: true,\n        data: {\n          connected: true,\n        },\n      });\n\n      const result = await DataSourceService.testConnection('ds-1');\n\n      expect(mockApiClient.post).toHaveBeenCalledWith('/data-sources/ds-1/test');\n      expect(result).toEqual({\n        connected: true,\n      });\n    });\n\n    it('should test failed connection', async () => {\n      mockApiClient.post.mockResolvedValueOnce({\n        success: true,\n        data: {\n          connected: false,\n          error: 'ECONNREFUSED',\n        },\n      });\n\n      const result = await DataSourceService.testConnection('ds-1');\n\n      expect(result).toEqual({\n        connected: false,\n        error: 'ECONNREFUSED',\n      });\n    });\n\n    it('should handle test API error', async () => {\n      mockApiClient.post.mockRejectedValueOnce(new Error('API error'));\n\n      await expect(DataSourceService.testConnection('ds-1')).rejects.toThrow('API error');\n    });\n  });\n\n  describe('AnalyticsService.query', () => {\n    const mockQuery: AnalyticsQuery = {\n      dataSource: 'ds-1',\n      metrics: ['users', 'sessions'],\n      dimensions: ['country', 'device'],\n      timeRange: {\n        start: '2024-01-01',\n        end: '2024-01-31',\n        preset: 'last30days',\n      },\n    };\n\n    const mockResponse = {\n      success: true,\n      data: {\n        data: [\n          {\n            dimensions: { country: 'US', device: 'desktop' },\n            metrics: { users: 1000, sessions: 1500 },\n            timestamp: '2024-01-01',\n          },\n          {\n            dimensions: { country: 'DE', device: 'mobile' },\n            metrics: { users: 800, sessions: 1200 },\n            timestamp: '2024-01-02',\n          },\n        ],\n        totalRows: 2,\n        query: mockQuery,\n        executionTime: 45,\n        cached: false,\n      },\n    };\n\n    it('should execute query successfully', async () => {\n      mockApiClient.post.mockResolvedValueOnce(mockResponse);\n\n      const result = await AnalyticsService.query(mockQuery);\n\n      expect(mockApiClient.post).toHaveBeenCalledWith('/analytics/query', mockQuery);\n      expect(result).toEqual(mockResponse.data);\n    });\n\n    it('should execute query with filters', async () => {\n      const queryWithFilters = {\n        ...mockQuery,\n        filters: [\n          {\n            field: 'country',\n            operator: 'equals' as const,\n            value: 'US',\n          },\n        ],\n      };\n\n      mockApiClient.post.mockResolvedValueOnce(mockResponse);\n\n      await AnalyticsService.query(queryWithFilters);\n\n      expect(mockApiClient.post).toHaveBeenCalledWith('/analytics/query', queryWithFilters);\n    });\n\n    it('should handle query execution error', async () => {\n      mockApiClient.post.mockResolvedValueOnce({\n        success: false,\n        message: 'Syntax error in SQL query',\n      });\n\n      await expect(AnalyticsService.query(mockQuery))\n        .rejects.toThrow('Syntax error in SQL query');\n    });\n\n    it('should handle empty query results', async () => {\n      mockApiClient.post.mockResolvedValueOnce({\n        success: true,\n        data: {\n          data: [],\n          totalRows: 0,\n          query: mockQuery,\n          executionTime: 10,\n          cached: false,\n        },\n      });\n\n      const result = await AnalyticsService.query(mockQuery);\n\n      expect(result.data).toHaveLength(0);\n      expect(result.totalRows).toBe(0);\n    });\n  });\n\n  describe('getAvailableMetrics and getAvailableDimensions', () => {\n    const mockMetrics = ['revenue', 'users', 'sessions', 'pageviews'];\n    const mockDimensions = ['country', 'device', 'browser', 'page'];\n\n    it('should get available metrics', async () => {\n      const mockResponse = {\n        data: mockMetrics,\n        success: true,\n      };\n      mockApiClient.get.mockResolvedValueOnce(mockResponse);\n\n      const result = await DataSourceService.getAvailableMetrics('ds-1');\n\n      expect(mockApiClient.get).toHaveBeenCalledWith('/data-sources/ds-1/metrics');\n      expect(result).toEqual(mockMetrics);\n    });\n\n    it('should get available dimensions', async () => {\n      const mockResponse = {\n        data: mockDimensions,\n        success: true,\n      };\n      mockApiClient.get.mockResolvedValueOnce(mockResponse);\n\n      const result = await DataSourceService.getAvailableDimensions('ds-1');\n\n      expect(mockApiClient.get).toHaveBeenCalledWith('/data-sources/ds-1/dimensions');\n      expect(result).toEqual(mockDimensions);\n    });\n  });\n});"],"names":["jest","mock","apiClient","get","fn","post","put","delete","createQueryFunction","describe","mockApiClient","beforeEach","clearAllMocks","mockDataSources","id","name","type","status","organizationId","workspaceId","lastSync","config","accountId","propertyId","viewId","baseUrl","authType","it","mockResponse","data","success","mockResolvedValueOnce","result","DataSourceService","getDataSources","expect","toHaveBeenCalledWith","toEqual","toHaveLength","toBe","mockRejectedValueOnce","Error","rejects","toThrow","mockDataSource","getDataSource","createRequest","mockCreatedDataSource","createDataSource","message","requestWithoutWorkspace","toBeUndefined","updateRequest","mockUpdatedDataSource","updateDataSource","nameOnlyUpdate","deleteDataSource","resolves","not","connected","testConnection","error","mockQuery","dataSource","metrics","dimensions","timeRange","start","end","preset","country","device","users","sessions","timestamp","totalRows","query","executionTime","cached","AnalyticsService","queryWithFilters","filters","field","operator","value","mockMetrics","mockDimensions","getAvailableMetrics","getAvailableDimensions"],"mappings":"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"}